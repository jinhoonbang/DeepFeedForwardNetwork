train_set_x
[ 600 9460]
train_set_y
[600  43]
valid_set_x
[ 200 9460]
valid_set_y
[200  43]
test_set_x
[ 200 9460]
test_set_y
[200  43]
... building the model
W
[[ 1.  1.  1. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]
 ..., 
 [ 1.  1.  1. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]]
B
[ 1.  1.  1. ...,  1.  1.  1.]
... training
epoch 1, minibatch 30/30, validation error 54.279070 % average loss 52.361892 %
     epoch 1, minibatch 30/30, test error of best model 53.093023 % average loss 52.361892 %
[[ 0.23778883  0.4893413   0.27286987 ...,  0.27191576  0.41040575
   0.31767849]
 [ 0.23781146  0.48930397  0.27288457 ...,  0.27191468  0.41040865
   0.31767667]
 [ 0.23780402  0.48930636  0.27288961 ...,  0.27189975  0.41043532
   0.31766492]
 ..., 
 [ 0.23765191  0.48942134  0.27292675 ...,  0.2716546   0.41085854
   0.31748686]
 [ 0.23767805  0.48939321  0.27292873 ...,  0.27168209  0.41078468
   0.31753322]
 [ 0.23766454  0.48940357  0.27293189 ...,  0.2716746   0.41080481
   0.31752059]]
Optimization complete. Best validation score of 54.279070 % obtained at iteration 30, with test performance 53.093023 %
The code for file SGD4FFN.py ran for 0.57m
(200, 43)
(200, 43)
0
68
0
132
68
0
132
0
0
64
0
136
61
0
139
0
0
73
0
127
0
66
0
134
0
76
0
124
0
40
0
160
84
0
116
0
0
59
0
141
76
0
124
0
0
65
0
135
0
60
0
140
0
80
0
120
60
0
140
0
0
63
0
137
74
0
126
0
0
63
0
137
0
69
0
131
62
0
138
0
0
69
0
131
0
45
0
155
111
0
89
0
0
44
0
156
69
0
131
0
0
55
0
145
0
76
0
124
0
46
0
154
110
0
90
0
0
44
0
156
0
61
0
139
90
0
110
0
0
49
0
151
0
60
0
140
0
80
0
120
60
0
140
0
0
65
0
135
0
80
0
120
55
0
145
0
0
43
0
157
110
0
90
0
0
47
0
153
0
54
0
146
107
0
93
0
0
39
0
161
0
60
0
140
93
0
107
0
0
47
0
153
88
0
112
0
0
32
0
168
0
80
0
120
68
0
132
0
0
56
0
144
0
76
0
124
56
0
144
0
0
79
0
121
0
65
0
135
49
0
151
0
0
100
0
100
0
51
0
149
0
73
0
127
0
47
0
153
80
0
120
0
0
61
0
139
62
0
138
0
0
77
0
123
0
17
0
183
160
0
40
0
0
23
0
177
0
39
0
161
121
0
79
0
0
40
0
160
0
79
0
121
0
54
0
146
67
0
133
0
0
48
0
152
95
0
105
0
0
57
0
143
0
27
0
173
138
0
62
0
0
35
0
165
0
28
0
172
142
0
58
0
0
30
0
170
0
32
0
168
129
0
71
0
0
39
0
161
0
29
0
171
143
0
57
0
0
28
0
172
0
52
0
148
85
0
115
0
0
63
0
137
0
11
0
189
171
0
29
0
0
18
0
182
0
75
0
125
0
38
0
162
87
0
113
0
0
39
0
161
107
0
93
0
0
54
0
146
0
33
0
167
127
0
73
0
0
40
0
160
0
22
0
178
155
0
45
0
0
23
0
177
75
0
125
0
0
34
0
166
0
91
0
109
0
31
0
169
127
0
73
0
0
42
0
158
76
0
124
0
0
36
0
164
0
88
0
112
0
42
0
158
124
0
76
0
0
34
0
166
85
0
115
0
0
31
0
169
0
84
0
116
0
69
0
131
0
47
0
153
84
0
116
0
0
84
0
116
43
0
157
0
0
73
0
127
fscore 0.46906976744186046
fscore
macro
0.169154228856
micro
0.34
weighted
0.172537313433
             precision    recall  f1-score   support

          0       0.44      0.50      0.47         8
          1       0.54      0.70      0.61        20
          2       0.12      0.07      0.09        15

avg / total       0.38      0.44      0.40        43

fscore
macro
0.155810983397
micro
0.305
weighted
0.142567049808
             precision    recall  f1-score   support

          0       0.33      0.30      0.32        10
          1       0.69      0.75      0.72        24
          2       0.25      0.22      0.24         9

avg / total       0.52      0.53      0.52        43

fscore
macro
0.197183098592
micro
0.42
weighted
0.248450704225
             precision    recall  f1-score   support

          0       0.33      0.38      0.35         8
          1       0.50      0.65      0.57        20
          2       0.38      0.20      0.26        15

avg / total       0.43      0.44      0.42        43

fscore
macro
0.183574879227
micro
0.38
weighted
0.209275362319
             precision    recall  f1-score   support

          0       0.33      0.27      0.30        11
          1       0.65      0.81      0.72        21
          2       0.12      0.09      0.11        11

avg / total       0.44      0.49      0.46        43

fscore
macro
0.153846153846
micro
0.3
weighted
0.138461538462
             precision    recall  f1-score   support

          0       0.33      0.23      0.27        13
          1       0.54      0.82      0.65        17
          2       0.50      0.31      0.38        13

avg / total       0.46      0.49      0.46        43

fscore
macro
0.1800486618
micro
0.37
weighted
0.199854014599
             precision    recall  f1-score   support

          0       0.44      0.33      0.38        12
          1       0.62      0.70      0.65        23
          2       0.25      0.25      0.25         8

avg / total       0.50      0.51      0.50        43

fscore
macro
0.157760814249
micro
0.31
weighted
0.146717557252
             precision    recall  f1-score   support

          0       0.56      0.45      0.50        11
          1       0.62      0.73      0.67        22
          2       0.12      0.10      0.11        10

avg / total       0.49      0.51      0.49        43

fscore
macro
0.237942122186
micro
0.555
weighted
0.396173633441
             precision    recall  f1-score   support

          0       0.33      0.30      0.32        10
          1       0.54      0.70      0.61        20
          2       0.25      0.15      0.19        13

avg / total       0.40      0.44      0.41        43

fscore
macro
0.171003717472
micro
0.345
weighted
0.176988847584
             precision    recall  f1-score   support

          0       0.22      0.22      0.22         9
          1       0.58      0.65      0.61        23
          2       0.12      0.09      0.11        11

avg / total       0.39      0.42      0.40        43

fscore
macro
0.236559139785
micro
0.55
weighted
0.390322580645
             precision    recall  f1-score   support

          0       0.22      0.29      0.25         7
          1       0.58      0.68      0.62        22
          2       0.25      0.14      0.18        14

avg / total       0.41      0.44      0.42        43

fscore
macro
0.206896551724
micro
0.45
weighted
0.279310344828
             precision    recall  f1-score   support

          0       0.44      0.36      0.40        11
          1       0.42      0.58      0.49        19
          2       0.25      0.15      0.19        13

avg / total       0.38      0.40      0.38        43

fscore
macro
0.153846153846
micro
0.3
weighted
0.138461538462
             precision    recall  f1-score   support

          0       0.22      0.17      0.19        12
          1       0.50      0.59      0.54        22
          2       0.12      0.11      0.12         9

avg / total       0.34      0.37      0.35        43

fscore
macro
0.143790849673
micro
0.275
weighted
0.11862745098
             precision    recall  f1-score   support

          0       0.11      0.14      0.12         7
          1       0.62      0.70      0.65        23
          2       0.25      0.15      0.19        13

avg / total       0.42      0.44      0.43        43

fscore
macro
0.236559139785
micro
0.55
weighted
0.390322580645
             precision    recall  f1-score   support

          0       0.44      0.31      0.36        13
          1       0.62      0.73      0.67        22
          2       0.12      0.12      0.12         8

avg / total       0.47      0.49      0.47        43

fscore
macro
0.232356134636
micro
0.535
weighted
0.372931596091
             precision    recall  f1-score   support

          0       0.44      0.40      0.42        10
          1       0.65      0.77      0.71        22
          2       0.38      0.27      0.32        11

avg / total       0.53      0.56      0.54        43

fscore
macro
0.211604095563
micro
0.465
weighted
0.295187713311
             precision    recall  f1-score   support

          0       0.22      0.20      0.21        10
          1       0.42      0.55      0.48        20
          2       0.12      0.08      0.10        13

avg / total       0.29      0.33      0.30        43

fscore
macro
0.203703703704
micro
0.44
weighted
0.268888888889
             precision    recall  f1-score   support

          0       0.56      0.45      0.50        11
          1       0.46      0.63      0.53        19
          2       0.25      0.15      0.19        13

avg / total       0.42      0.44      0.42        43

fscore
macro
0.169154228856
micro
0.34
weighted
0.172537313433
             precision    recall  f1-score   support

          0       0.22      0.25      0.24         8
          1       0.65      0.74      0.69        23
          2       0.12      0.08      0.10        12

avg / total       0.43      0.47      0.44        43

fscore
macro
0.145833333333
micro
0.28
weighted
0.1225
             precision    recall  f1-score   support

          0       0.56      0.45      0.50        11
          1       0.62      0.70      0.65        23
          2       0.38      0.33      0.35         9

avg / total       0.55      0.56      0.55        43

fscore
macro
0.131191432396
micro
0.245
weighted
0.0964257028112
             precision    recall  f1-score   support

          0       0.33      0.27      0.30        11
          1       0.73      0.86      0.79        22
          2       0.12      0.10      0.11        10

avg / total       0.49      0.53      0.51        43

fscore
macro
0.190476190476
micro
0.4
weighted
0.228571428571
             precision    recall  f1-score   support

          0       0.56      0.38      0.45        13
          1       0.58      0.75      0.65        20
          2       0.50      0.40      0.44        10

avg / total       0.55      0.56      0.54        43

fscore
macro
0.157760814249
micro
0.31
weighted
0.146717557252
             precision    recall  f1-score   support

          0       0.11      0.10      0.11        10
          1       0.62      0.73      0.67        22
          2       0.50      0.36      0.42        11

avg / total       0.47      0.49      0.47        43

fscore
macro
0.296296296296
micro
0.8
weighted
0.711111111111
             precision    recall  f1-score   support

          0       0.22      0.40      0.29         5
          1       0.65      0.71      0.68        24
          2       0.50      0.29      0.36        14

avg / total       0.55      0.53      0.53        43

fscore
macro
0.251298026999
micro
0.605
weighted
0.456105919003
             precision    recall  f1-score   support

          0       0.22      0.33      0.27         6
          1       0.69      0.72      0.71        25
          2       0.25      0.17      0.20        12

avg / total       0.50      0.51      0.50        43

fscore
macro
0.167290886392
micro
0.335
weighted
0.168127340824
             precision    recall  f1-score   support

          0       0.56      0.36      0.43        14
          1       0.50      0.72      0.59        18
          2       0.38      0.27      0.32        11

avg / total       0.49      0.49      0.47        43

fscore
macro
0.214689265537
micro
0.475
weighted
0.30593220339
             precision    recall  f1-score   support

          0       0.33      0.27      0.30        11
          1       0.62      0.70      0.65        23
          2       0.38      0.33      0.35         9

avg / total       0.49      0.51      0.50        43

fscore
macro
0.272189349112
micro
0.69
weighted
0.563431952663
             precision    recall  f1-score   support

          0       0.44      0.40      0.42        10
          1       0.58      0.75      0.65        20
          2       0.38      0.23      0.29        13

avg / total       0.49      0.51      0.49        43

fscore
macro
0.276803118908
micro
0.71
weighted
0.589590643275
             precision    recall  f1-score   support

          0       0.22      0.22      0.22         9
          1       0.65      0.71      0.68        24
          2       0.12      0.10      0.11        10

avg / total       0.44      0.47      0.45        43

fscore
macro
0.261398176292
micro
0.645
weighted
0.505805471125
             precision    recall  f1-score   support

          0       0.44      0.50      0.47         8
          1       0.58      0.83      0.68        18
          2       0.62      0.29      0.40        17

avg / total       0.57      0.56      0.53        43

fscore
macro
0.277939747328
micro
0.715
weighted
0.596180758017
             precision    recall  f1-score   support

          0       0.44      0.33      0.38        12
          1       0.54      0.64      0.58        22
          2       0.25      0.22      0.24         9

avg / total       0.45      0.47      0.45        43

fscore
macro
0.198830409357
micro
0.425
weighted
0.25350877193
             precision    recall  f1-score   support

          0       0.33      0.50      0.40         6
          1       0.65      0.68      0.67        25
          2       0.25      0.17      0.20        12

avg / total       0.50      0.51      0.50        43

fscore
macro
0.307277628032
micro
0.855
weighted
0.788167115903
             precision    recall  f1-score   support

          0       0.44      0.31      0.36        13
          1       0.50      0.68      0.58        19
          2       0.12      0.09      0.11        11

avg / total       0.39      0.42      0.39        43

fscore
macro
0.202090592334
micro
0.435
weighted
0.263728222997
             precision    recall  f1-score   support

          0       0.56      0.33      0.42        15
          1       0.38      0.77      0.51        13
          2       0.62      0.33      0.43        15

avg / total       0.53      0.47      0.45        43

fscore
macro
0.232356134636
micro
0.535
weighted
0.372931596091
             precision    recall  f1-score   support

          0       0.33      0.27      0.30        11
          1       0.54      0.74      0.62        19
          2       0.38      0.23      0.29        13

avg / total       0.44      0.47      0.44        43

fscore
macro
0.258919469929
micro
0.635
weighted
0.493241590214
             precision    recall  f1-score   support

          0       0.44      0.36      0.40        11
          1       0.62      0.73      0.67        22
          2       0.12      0.10      0.11        10

avg / total       0.46      0.49      0.47        43

fscore
macro
0.291079812207
micro
0.775
weighted
0.67676056338
             precision    recall  f1-score   support

          0       0.33      0.21      0.26        14
          1       0.65      0.89      0.76        19
          2       0.12      0.10      0.11        10

avg / total       0.43      0.49      0.44        43

fscore
macro
0.181818181818
micro
0.375
weighted
0.204545454545
             precision    recall  f1-score   support

          0       0.22      0.18      0.20        11
          1       0.50      0.68      0.58        19
          2       0.38      0.23      0.29        13

avg / total       0.39      0.42      0.39        43

fscore
macro
0.258919469929
micro
0.635
weighted
0.493241590214
             precision    recall  f1-score   support

          0       0.33      0.30      0.32        10
          1       0.46      0.63      0.53        19
          2       0.50      0.29      0.36        14

avg / total       0.44      0.44      0.43        43

fscore
macro
0.183574879227
micro
0.38
weighted
0.209275362319
             precision    recall  f1-score   support

          0       0.56      0.38      0.45        13
          1       0.35      0.82      0.49        11
          2       0.62      0.26      0.37        19

avg / total       0.53      0.44      0.43        43

fscore
macro
0.255144032922
micro
0.62
weighted
0.474567901235
             precision    recall  f1-score   support

          0       0.22      0.17      0.19        12
          1       0.38      0.71      0.50        14
          2       0.25      0.12      0.16        17

avg / total       0.29      0.33      0.28        43

fscore
macro
0.198830409357
micro
0.425
weighted
0.25350877193
             precision    recall  f1-score   support

          0       0.22      0.29      0.25         7
          1       0.58      0.71      0.64        21
          2       0.50      0.27      0.35        15

avg / total       0.49      0.49      0.47        43

fscore
macro
0.197183098592
micro
0.42
weighted
0.248450704225
             precision    recall  f1-score   support

          0       0.22      0.22      0.22         9
          1       0.58      0.79      0.67        19
          2       0.50      0.27      0.35        15

avg / total       0.48      0.49      0.46        43

fscore
macro
0.117969821674
micro
0.215
weighted
0.0760905349794
             precision    recall  f1-score   support

          0       0.33      0.18      0.23        17
          1       0.46      0.67      0.55        18
          2       0.25      0.25      0.25         8

avg / total       0.37      0.40      0.37        43

